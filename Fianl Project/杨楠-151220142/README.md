葫芦娃大战妖怪——2D版
==
规则介绍
--
葫芦娃只想和爷爷过安稳的生活，然而妖怪们总要兴风作浪，于是一场葫芦娃与妖怪的大战便一触即发。然而一旦爷爷被妖怪吃了，葫芦娃也就丧失了斗志，失去了人生的意义，也就是game over！妖怪们的目标就是吃掉爷爷，而葫芦娃的目标就是保护爷爷，顺便消灭所有不法的妖怪。

论单打独斗，小喽啰们当然打不过葫芦娃。不过妖怪多了，葫芦娃也独木难支。具体地，每个葫芦娃有3hp，每个妖怪论名气大小hp不等，比如蛇精hp就比一般小喽啰多一些。每次葫芦娃和妖怪战斗，两人都会受伤，减少部分hp。当hp归0时不管是葫芦娃还是妖怪都躺尸了。

总体采用的是关卡模式，关卡越高，妖怪们的hp就越多，打架时给葫芦娃造成的伤害就越大。显然，随着妖怪们的不断升级，后面阶段光凭葫芦娃们是打不过妖怪了，因此许多关卡都设置了物品，助葫芦娃一臂之力。同时，为了减少妖怪与葫芦娃的正面交锋，体现妖怪的奸诈，每个关卡都一些地形是无法逾越的路障，延缓每个关卡的时间。

核心原理
--
每个葫芦娃或者妖怪都是一个线程，外加一个显示最新交锋情况的显示线程。显示线程与Creature们的线程交替进行。葫芦娃和妖怪们每走一次，显示线程就输出一次。这里用到了之前洗车的例子——同步锁，不同的是，待所有葫芦娃和妖怪全走了一个onestep()，才切换至显示线程，所以需要防止切换显示进程之前某个Creature多走了一步或者少走了一步，因此为每个Creature都配置了一个self_move。当进入读档模式时，只需要一个显示线程，每隔一定的sleeptime后显示下一个战斗画面。

图像结构
--
整个程序的图形界面由4个图层构成。最下层是tile层，铺设能走的地形。第二层是item层，关卡里的道具和死亡的尸体就放置于此。第三层是Creature层，也就是葫芦娃和妖怪们所处的次元，执行线程的场所。最上层是Extra层，用以存放某时刻出现的特效，例如获取药水hp上升、两败俱伤hp下降的提示。

后记
--
整个工程用到了面向对象的封装、继承、多态的三大特点，也用到了模板、线程、注释、测试、输入输出以及异常处理。而且，这个程序是以开闭原则为核心设计的。生物们的核心移动已经实现无需修改，但整个游戏可以不断扩展：在level类中设置新的关卡，creature类中设置新的妖怪属性，middle类中设置新的物品，base类中设置新的地形等，并且可以建新类继承它们来实现新的功能。虽然时间紧迫，只做了2个样例关卡，但却可以不断扩充成一个丰富多彩的游戏。

遗留问题
--
通过mvn构建的工程导入eclipse完成实现后，由于eclipse不像intelliJ IDEA那样与mvn完全适应，通过mvn命令生成文件产生各种警告，原先在eclipse全部通过的测试也无法通过了（暂时改成ignore来生成package）。看来下学期的大实验是该把eclipse换成intelliJ了！

*每次打斗的记录保存在外目录下文件data.hlw中。*

**关卡1信息：草地**

小喽啰 hp 1 伤害 1

蝎子精 hp 2 伤害 1

蛇精    hp 2 伤害 1

**关卡2信息：湖边**

红魔头 hp 2 伤害 1

黑魔头 hp 2 伤害 1

小王  hp 3 伤害 2

圣水：葫芦娃获得 hp+1
**妖怪们无法获得圣！水！**
