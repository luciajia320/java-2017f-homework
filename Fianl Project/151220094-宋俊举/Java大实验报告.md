# 葫芦娃大战
151220094-宋俊举
## 1.操作方法
1.开始会显示葫芦娃与蝎子精，小喽啰的开始位置，因为图片处理技术不好，有时加载图片可能会卡顿，请等全部单位加载完成后再进行操作。

2.按下空格时开始自动战斗，战斗过程会自动保存文件至项目文件目录下的record.txt中

3.战斗结束后退出程序，但要注意保存record.txt文件，重命名文件或者将改文件移动/复制到别处，因为再次运行程序会将record.txt文件清空并重新写入。

4.在开始界面时按下L键会出现选择文件对话框，请选择正确的战斗记录文件，加载文件的时间可能会很长，请耐心等待(在自己机器上测试有时加载半分钟左右，有时加载几分钟，可能跟记录文件大小有关)。

## 2.多线程实现

### 2.1 资源共享

将每一个Position设置成一个共享资源进行封装，设置角色，清空角色，获取角色信息等方法执行时都会加锁，防止线程冲突。

### 2.2 Runnable接口

定义Creature接口，继承于Runnable接口，即每一个角色都是一个线程

### 2.3 线程协作

只有葫芦娃才能主动进行战斗。若葫芦娃发现敌人，将会进入战斗，设置战斗标志变量为战斗状态，同时将发现的敌人也设置成战斗状态。毕竟正义终将战胜邪恶(其实是胜率低于80%葫芦娃仍有较大频率输)，所以将葫芦娃胜率上调为80%，若某个角色死亡，run函数执行结束，但这个对象仍在，只是不会再进行任何修改操作，只能读取信息，即留下了尸体。

## 3.类之间的继承关系与基本操作

## 3.1 Creature接口

同上述所讲Creature类继承于Runnable接口，新添加了获取位置信息，设置位置信息，判断角色是否死亡，杀死角色，获取角色图片，获取尸体图片，设置行动冷却，获取阵营信息，进入战斗状态，获取编号，设置编号等信息。

## 3.2 Huluwa,Xiezijing&Slime

这三个类分别是葫芦娃类，蝎子精类，小喽啰类，继承于Creature接口，并重写run函数，程序运行时作为单个线程使用

## 3.3 Position类

同2介绍，这个类封装成了一个共享资源，每次进行访问或者修改时都会进行加锁，防止线程冲突

## 3.4 Field类

Field类继承于JPanel类，准备进行图形化显示，Field类里包含Position数组，并在Field类里进行图片初始化，为了节省空间以及提高加载效率(不知是我程序原因还是电脑性能低或者是找的图片有问题，若不修改每次初始化时耗时很长)每个角色类的图片都设置为了static变量，在Field构造函数里进行初始化

## 3.5 World类

World类继承于JFrame类，进行图形化初始化，在这里封装Field类中的paint函数，方便main函数进行调用。实现线程初始化函数。

## 4 要求说明

除了maven至今未配置成功之外，以及测试部分未做，其余都已实现。战斗可能没有那么生动有趣。。