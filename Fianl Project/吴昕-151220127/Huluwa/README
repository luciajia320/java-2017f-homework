# 葫芦娃大战妖精

#### 你好，我的女神是[Skye](https://github.com/SkyeWoo)
------

免责声明：我的童年没有葫芦娃，所以如果我对剧情有什么误解讲道理你是不能打我的。

![葫芦娃大战妖怪](https://camo.githubusercontent.com/a5cc35d2179c5bf861f6a8eeca25fc5fa3e876a2/687474703a2f2f656e676c6973682e6372692e636e2f6d6d736f757263652f696d616765732f323030392f30362f32342f34363334636172746f6e312e6a7067g)

- 游戏说明
- 说一段神话
 - 盘古是如何开天地的
 - 女娲是如何造人的
 - 伏羲是如何画卦的
 - 金乌是如何称霸的
 - 精卫是如何填海的
 - 后羿是如何射日的
 - 仓颉是如何造字的
+ 致谢

------
## 游戏说明

只有**葫芦娃**和**小喽**是具备战斗能力的，**爷爷**很鸡肋，不会跑不会动；**蝎子精**和**蛇精**站着指挥不腰疼，**葫芦娃**死了**爷爷**就保不住了，，**蝎子精**和**蛇精**没了**小喽**的保护打不过葫芦娃了，要被压在七色山下了(我不接受反驳我又没看过葫芦娃！我不管！游戏规则我来定！）

* 为了您的方便，我搞了个菜单栏，功能还是比较浅显易懂的。
*开始新游戏/退出游戏*, *暂停/继续*, *帮助*
* 当你按下**空格**键，所有角色会倾巢出动。如果您忘了的话可以在*帮助*里面查看这条规则。当一方全部死亡游戏结束。此时你可以*开始新游戏*或者*再现某个游戏过程*或者*结束游戏*。
* 存档：
    1. 保存：存档规则是从save文件夹下已有存档后一个数开始建立新存档。比如你现在已经有了存档0-4，那么本次运行自动保存为5。
    2. 读取存档：在开始界面按**L**键可以读取存档。结束游戏时会自动弹出对话框，选择*读取存档*也可以读取当前已有存档。
    3. 场景再现：选择存档之后按键盘上的**→**键可以分步查看角色运行轨迹。如果不想看了的话可以按**L**键读取另一个存档或在菜单栏中*开始新游戏*或*退出*。

* 在游戏进行中，敌对的双方相遇，两虎相争必有一伤，不是你死就是我亡。上帝是公平的，两个角色挂掉的几率都是相等的。仍旧活着的人只能含泪或者怀着愤恨的心情踏着兄弟和敌人的尸体前进。
* 我比较菜鸡，只对**Formation**和**Creature**以及一个自定义**异常OutOfBounceException**作了测试，测试跟我一样菜鸡。
* **mvn clean package**生成的jar包在*target*文件夹下。

------

## 说一段神话

### 盘古是如何开天地的
很多像我一样一学期没有好好学习的人会说大作业堆在期末码简直是女娲补天。
对我不是。
对我是盘古开天地。
天地都没开，补个屁。
你好，我是盘古。

神说，要有光。

然后我拿到了一个来自**Swing**的**JFrame**，我想这是我的混沌。我把它切开了。
然后呢。这个可愁死我了。我是真愁死了。但我也没白死。
混沌轻的往上浮，我的眼睛变成了日月星光照亮这个世界，于是混沌里有了**Menu**，算是有了全局大概方向了吧。
重的往下沉，我的肢体躯干变成了后世种种元素。我的心还在，这是一只**Graphics**画笔，通过它我可以描绘我之后整个世界的模样。但这个我是看不到了的，毕竟我已经死了。暂且叫它**Main**吧。

### 女娲是如何造人的
“用对象的角度思考问题”
问题来了，是怎么找到对象的。
“程序猿怕什么没有对象。没有对象的时候就new一个啊。”
于是女娲来造人了。

葫芦娃是对象，爷爷是，妖怪是，这些对象统称角色。好了，Creature类有了。
老师说，要抽象。然后把场地给抽象出来了。我听说的时候，这也行？！好了，Ground类有了。
Creature要怎么到Ground啊。“葫芦娃是站在荷叶上的，荷叶是会移动的。荷叶也是对象。”忘了原话是什么，大意是这样。然后荷叶也有了。这个东西，在后来，叫作坐标。好了，Location类有了。

女娲捏了鼻子眼睛嘴巴，然后这些类有了各自的成员变量和成员函数。
女娲吹了一口仙气，然后这些类就被实例化成了对象。女娲把这些对象统统放进了***creatures***里面。
葫芦娃终于会跑会跳了啊，并且女娲让他进化到足够高级免去了傻兮兮的报数，还会判断是不是和别的对象撞上了啊，还学会了打架，撞不上他还会去找距离他最近的那个对象的麻烦，还可能打不赢。

女娲尽力了。

### 伏羲是如何画卦的
伏羲说，女娲你这个业务能力很不行啊。
打架是不能盲打的。要有敌我，要排兵布阵，要天时地利人和，还要有啦啦队。

于是女娲的儿女首先有了身份，**Creature**被划分成了**Huluwa**, **Grandpa**, **Monster**, **Scorpion**, **Snake**这些子类。儿大不由娘，想换脸。娘没办法，**abstract**了一个*setImg()*供娃整容。

伏羲为了这群熊孩子能打赢也是操碎了心，为了能往**Ground**上放，先把他们放进一个阵型里面，再在**Ground**上放置所有角色。伏羲为他们量身定制了两个阵型，给葫芦娃选了鹤翼，给小喽选了n。（说实话，老师提供的那些阵型高端到我连读都不会读，选这两个纯粹是因为眼缘。）

阵型有了，要让他们行军啊。于是每个对象都成了一个**线程**，伏羲是总指挥，他说“前进”，他们就前进。至于怎么前进的，这个是每个线程里面怎么*run()*和*move()*的问题，伏羲不需要考虑，他只要在整个天地里设一个监听，他想让他们动的时候就按**空格**键。

### 金乌是如何称霸的

伏羲忘了一个很严重的问题。
这群熊孩子，都还是孩子，是真的皮。
每个孩子都争着抢着要前进，就一片场地，由着这群熊孩子糟蹋，能不玩完么？
很快，这片场地就被这十几个金乌烤焦了。

两只金乌碰撞*battle()*了一下，然后两只都扑棱着翅膀又撞到了场地上其他活着的金乌，然后是一场乱战。伏羲很奇怪，刚刚不是明明*conflict()*了吗？我不是明明判断*movable()*了吗？刚刚不是明明死了一只了吗？
他忘了，金乌会挣扎战斗到最后一口气，你掐着它的脖子是没法阻止它去抢别人的场地的。

### 精卫是如何填海的

关键时候还是女娃精细啊。她看到了高高在上的伏羲看不到的问题。
她悄咪咪赶在每个金乌要争夺的资源前，在被争夺资源上加了一个**synchronized**。这可是个大工程啊。

如果直接对场地**ground**加锁，就像妄想一下把海填平一样，结果是几乎所有的线程都**阻塞**不通。还是要降低**synchronized**的粒度，一颗一颗石子扔，扔在要害的地方才好。

精卫就这么一点一点填海，但海是填不平的，总有那么两个线程在游戏结束的时候还在碰撞，就像天空中最后两颗太阳一样，结束提示对话框以小概率会出现多次。

### 后羿是如何射日的

精卫只是一只鸟，不能苛求她太多了。
然后最后的救世主后羿出现了。

他创造了一把弓，是Ground的static变量，叫作state，凭着这把弓他可以看到整个场地的现状，是*READY*, *GOING*, *PAUSE*或是*OVER*等等。
然后他又造了一把箭，也是一个**线程**，因为他觉得要以毒攻毒。这把箭可比这群金乌厉害得多，它是**ground** **implements**的一个方法，它站得更高目标更远，重要的是这把箭能回头，它知道什么时候要持续，什么时候要停止运行。当弓观测到全局为*OVER*等状态的时候，箭就要做出出筒或者静候等相应措施。

```java
@Override
public void run() {
    while (mf.thread.isInterrupted() == false) {
        if (state == STATE.OVER) {
            Creature cre = null;
            for (Creature c : creatures)
                if (c.live == true) {
                    cre = c; break;
                }
            gameOver(cre);
            mf.thread.interrupt();
        }
    }
}
```

### 仓颉是如何造字的

至此，天下终于太平了。人类进入了一个新世界。
这个世界还称不上文明。因为它没有记忆。
文明何时有记忆？自有记录开始。

仓颉看到世人的争伤抢夺，觉得应该给予后人以警告。他发明了一种文字叫**存档**来记录历史。
他几乎是空降到这个世界上的，从降临的那一刻他就给世界带来了**FileWriter**，这可是个好东西。每每开战，仓颉就调用*newSave()*开始记录，一旦有人*move()*一步，仓颉都会观察时局有没有变动，然后利用**FileWriter**记下每一步。
仓颉记录是为了告诉后人要止戈，要和平，你看看这些惨痛的历史，你自己按**L**键看看，或者从对话框里选择*读取存档*看看前人打过的仗。他不仅教会我们写，还教会我们用**BufferedReader**读，通过**存档**，你甚至可以通过**→**键看到每个角色是如何一步步走向死亡的。

仓颉叹了口气说，要佛性。

------

## 致谢

首先，感谢容忍我的胡说八道。//虽然我觉得我讲的很有道理。

感谢两位老师的辛勤付出，营造了很轻松愉悦的氛围，玩着学java。
墙裂推荐选修曹老师余老师的java课，是真的很好玩。一学期下来可以皮死你。
如果选修了就好好跟着两位老师学，跟着两位老师的进度一点点来，不要像我一样吊儿郎当的在期末再在这边肝得脑子不清醒了。

感谢听我吐槽的各位同僚。感谢和我一起吐槽的各位同僚。

平时不努力，考前抱佛脚。下面是我这次大作业参考的一些资料：

[1]：JUnit单元测试--IntelliJ IDEA
https://www.cnblogs.com/huaxingtianxia/p/5563111.html

[2]：Maven简单使用
https://www.cnblogs.com/sunddenly/p/4341542.html

[3]：没有想过有一天会在b站上学java
http://www.bilibili.com/video/av14871407/

[4]：坦克大战小游戏教程和源码

听说这次java试卷很难，我要留点脑细胞去复习了。